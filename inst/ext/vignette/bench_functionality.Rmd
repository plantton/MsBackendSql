---
title: "A simple SQL-backend for Spectra metadata" 
author: "Laurent Gatto, Chong Tang"
output: 
    BiocStyle::html_document:
        toc_float: true
---

```{r style, echo = FALSE, results = 'asis', message = FALSE}
BiocStyle::markdown()
```

# Introduction

In this vignette, we want to benchmark 2 backends for the package `Spectra`:
`MsBackendSql` and `MsBackendDataFrame`, to assess functionality of these 2 
backends.

# Usage

We will need the following packages:

```{r env, message = FALSE}
library(MsBackendSql)
library(Spectra)
library(mzR)
library(RSQLite)
library(msdata)
library(peakRAM)
library(tidyverse)
library(pryr)
```

The example below demonstrates the functionality of `MsBackendSql` with a single 
file:

```{r usage1, warning = FALSE}
f <- msdata::proteomics(full.names = TRUE)[4]
conn1 <- dbConnect(SQLite(), "b1.db")
b1 <- backendInitialize(MsBackendSqlDb(), dbcon = conn1, files = f)
object_size(b1)
```

We can also read raw MS files with `MsBackendMzR` backend, then change backend 
to `MsBackendDataFrame`. 

```{r usage 2}
b2 <- Spectra(f, backend = MsBackendMzR())
b2 <- setBackend(b2, MsBackendDataFrame())
b2
```

